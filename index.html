<!DOCTYPE html>
<html>
<head>
    <title>Elite Fleet Monitor</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        #map { height: 70vh; width: 100%; border: 2px solid red; }
        .controls { padding: 20px; background: #222; color: white; display: flex; gap: 10px; }
        button { padding: 10px; cursor: pointer; background: red; color: white; border: none; }
    </style>
</head>
<body>

<div class="controls">
    <button onclick="sendCommand('take_pic')">ğŸ“¸ Take Photo</button>
    <button onclick="sendCommand('record_audio')">ğŸ™ï¸ Record Audio</button>
    <div id="status">Car-01 Status: Offline</div>
</div>
<div id="map"></div>

<script>
    const firebaseConfig = { databaseURL: "https://mytrecker2-b3535-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Map Initialize
    var map = L.map('map').setView([0, 0], 15);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    var marker = L.marker([0, 0]).addTo(map);

    // Live Tracking Connection
    db.ref('vehicles/Car-01').on('value', (snapshot) => {
        const data = snapshot.val();
        if(data) {
            marker.setLatLng([data.lat, data.lng]);
            map.panTo([data.lat, data.lng]);
            document.getElementById("status").innerHTML = "Car-01 Online | Speed: " + (data.speed || 0) + "km/h";
        }
    });

    // Remote Command Function
    function sendCommand(cmd) {
        db.ref('commands/Car-01').set({ action: cmd, time: Date.now() });
        alert("Command Sent: " + cmd);
    }
</script>
</body>
</html>
